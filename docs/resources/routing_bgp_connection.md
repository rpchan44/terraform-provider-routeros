# routeros_routing_bgp_connection (Resource)
> [!WARNING] Using this resource you may happen unexpected behavior, for example, some of the attributes may not be removable after adding them to the TF configuration. Please report this to GitHub and it may be possible to fix it. Use the resource at your own risk as it is!

## Example Usage
```terraform
resource "routeros_routing_bgp_connection" "test" {
  name         = "neighbor-test"
  as           = "65550/5"
  as_override  = true
  add_path_out = "none"
  remote {
    address = "172.17.0.1"
    as      = "12345/5"
  }
  local {
    role = "ebgp"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `as` (String) 32-bit BGP autonomous system number. Value can be entered in AS-Plain and AS-Dot formats. The parameter is also used to set up the BGP confederation, in the following format: confederation_as/as . For example, if your AS is 34 and your confederation AS is 43, then as configuration should be as =43/34.
- `name` (String) Name of the BGP connection.

### Optional

- `add_path_out` (String)
- `address_families` (String) List of address families about which this peer will exchange routing information. The remote peer must support (they usually do) BGP capabilities optional parameter to negotiate any other families than IP.
- `cisco_vpls_nlri_len_fmt` (String) VPLS NLRI length format type. Used for compatibility with Cisco VPLS.
- `cluster_id` (String, Deprecated) In case this instance is a route reflector: the cluster ID of the router reflector cluster to this instance belongs. This attribute helps to recognize routing updates that come from another route reflector in this cluster and avoid routing information looping. Note that normally there is only one route reflector in a cluster; in this case, 'cluster-id' does not need to be configured and BGP router ID is used instead.
- `comment` (String)
- `connect` (Boolean) Whether to allow the router to initiate the connection.
- `disabled` (Boolean)
- `hold_time` (String) Specifies the BGP Hold Time value to use when negotiating with peers. According to the BGP specification, if the router does not receive successive KEEPALIVE and/or UPDATE and/or NOTIFICATION messages within the period specified in the Hold Time field of the OPEN message, then the BGP connection to the peer will be closed. The minimal hold-time value of both peers will be actually used (note that the special value 0 or 'infinity' is lower than any other value) infinity - never expire the connection and never send keepalive messages.
- `input` (Block List, Max: 1) A group of parameters associated with BGP input. (see [below for nested schema](#nestedblock--input))
- `instance` (String) Name of the instance this VPN is assigned to.
- `keepalive_time` (String) How long to keep the BGP session open after the last received 'keepalive' message.
- `listen` (Boolean) Whether to listen for incoming connections.
- `local` (Block List, Max: 1) A group of parameters associated with BGP input. (see [below for nested schema](#nestedblock--local))
- `multihop` (Boolean) Specifies whether the remote peer is more than one hop away. This option affects outgoing next-hop selection as described in RFC 4271 (for EBGP only, excluding EBGP peers local to the confederation). It also affects: whether to accept connections from peers that are not in the same network (the remote address of the connection is used for this check); whether to accept incoming routes with NEXT_HOP attribute that is not in the same network as the address used to establish the connection; the target-scope of the routes installed from this peer; routes from multi-hop or IBGP peers resolve their next-hops through IGP routes by default.
- `nexthop_choice` (String) Affects the outgoing NEXT_HOP attribute selection. Note that next-hops set in filters always take precedence. Also note that the next-hop is not changed on route reflection, except when it's set in the filter. default - select the next-hop as described in RFC 4271 force-self - always use a local address of the interface that is used to connect to the peer as the next-hop; propagate - try to propagate further the next-hop received; i.e. if the route has BGP NEXT_HOP attribute, then use it as the next-hop, otherwise, fall back to the default case.
- `output` (Block List, Max: 1) A group of parameters associated with BGP output. (see [below for nested schema](#nestedblock--output))
- `remote` (Block List, Max: 1) A group of parameters associated with BGP input. (see [below for nested schema](#nestedblock--remote))
- `router_id` (String, Deprecated) BGP Router ID to be used. Use the ID from the /routing/router-id configuration by specifying the reference name, or set the ID directly by specifying IP. Equal router-ids are also used to group peers into one instance.
- `routing_table` (String) Name of the routing table, to install routes in.
- `save_to` (String) Filename to be used to save BGP protocol-specific packet content (Exported PDU) into pcap file. This method allows much simpler peer-specific packet capturing for debugging purposes. Pcap files in this format can also be loaded to create virtual BGP peers to recreate conditions that happened at the time when packet capture was running.
- `tcp_md5_key` (String, Sensitive) The key used to authenticate the connection with TCP MD5 signature as described in RFC 2385. If not specified, authentication is not used.
- `templates` (Set of String) List of the template names, to inherit parameters from. Useful for dynamic BGP peers.
- `use_bfd` (Boolean) Whether to use the BFD protocol for faster connection state detection.
- `vrf` (String) The VRF table this resource operates on.

### Read-Only

- `id` (String) The ID of this resource.
- `inactive` (Boolean)

<a id="nestedblock--input"></a>
### Nested Schema for `input`

Optional:

- `accept_communities` (String) A quick way to filter incoming updates with specific communities. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as 'not active, filtered'. Changes to be applied required session refresh.
- `accept_ext_communities` (String) A quick way to filter incoming updates with specific extended communities. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as 'not active, filtered'. Changes to be applied required session refresh.
- `accept_large_communities` (String) A quick way to filter incoming updates with specific large communities. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as 'not active, filtered'. Changes to be applied required session refresh.
- `accept_nlri` (String) Name of the ipv4/6 address-list. A quick way to filter incoming updates with specific NLRIs. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as 'not active, filtered'. Changes to be applied required session restart.
- `accept_unknown` (String, Deprecated) A quick way to filter incoming updates with specific 'unknown' attributes. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as 'not active, filtered'. Changes to be applied required session refresh.
- `affinity` (String) Configure input multi-core processing. Read more in Routing Protocol Multi-core Support article. alone - input and output of each session are processed in its own process, most likely the best option when there are a lot of cores and a lot of peers afi, instance, vrf, remote-as - try to run input/output of new session in process with similar parameters main - run input/output in the main process (could potentially increase performance on single-core even possibly on multi-core devices with a small amount of cores) input - run output in the same process as input (can be set only for output affinity)
- `allow_as` (Number) Indicates how many times to allow your own AS number in AS-PATH, before discarding a prefix.
- `filter` (String) Name of the routing filter chain to be used on input prefixes. This happens after NLRIs are processed. If the chain is not specified, then BGP by default accepts everything.
- `filter_communities` (String) A quick way to filter incoming updates with specific communities. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as "not active, filtered". Changes to be applied required session refresh.
- `filter_ext_communities` (String) A quick way to filter incoming updates with specific extended communities. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as "not active, filtered". Changes to be applied required session refresh.
- `filter_large_communities` (String) A quick way to filter incoming updates with specific large communities. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as "not active, filtered". Changes to be applied required session refresh.
- `filter_nlri` (String) Name of the filter chain that will filter incoming IPv4/IPv6 NLRIs directly before they are  stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in `/routing route` table as `not active, filtered`. Changes to be applied required session restart.
- `filter_unknown` (String) A quick way to filter incoming updates with specific "unknown" attributes. It allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in /routing route table as "not active, filtered". Changes to be applied required session refresh.
- `ignore_as_path_len` (Boolean, Deprecated) Whether to ignore the AS_PATH attribute in the BGP route selection algorithm
- `limit_process_routes_ipv4` (Number) Try to limit the amount of received IPv4 routes to the specified number. This number does not represent the exact number of routes going to be installed in the routing table by the peer. BGP session 'clear' command must be used to reset the flag if the limit is reached.
- `limit_process_routes_ipv6` (Number) Try to limit the amount of received IPv6 routes to the specified number. This number does not represent the exact number of routes going to be installed in the routing table by the peer. BGP session 'clear' command must be used to reset the flag if the limit is reached.


<a id="nestedblock--local"></a>
### Nested Schema for `local`

Required:

- `role` (String) BGP role, in most common scenarios it should be set to iBGP or eBGP. More information on BGP roles can be found in the corresponding [RFC draft](https://datatracker.ietf.org/doc/draft-ietf-idr-bgp-open-policy/?include_text=1)

Optional:

- `address` (String) Local connection IPv4/6 address.
- `port` (Number) Local connection port.
- `ttl` (Number) Time To Live (hop limit) that will be recorded in sent TCP packets.

Read-Only:

- `default_address` (String)


<a id="nestedblock--output"></a>
### Nested Schema for `output`

Optional:

- `affinity` (String) Configure output multicore processing. Read more in Routing Protocol Multi-core Support article. alone - input and output of each session is processed in its own process, the most likely best option when there are a lot of cores and a lot of peers afi, instance, vrf, remote-as - try to run input/output of new session in process with similar parameters main - run input/output in the main process (could potentially increase performance on single-core even possibly on multicore devices with small amount of cores) input - run output in the same process as input (can be set only for output affinity).
- `as_override` (Boolean) If set, then all instances of the remote peer's AS number in the BGP AS-PATH attribute are replaced with the local AS number before sending a route update to that peer. Happens before routing filters and prepending.
- `default_originate` (String) Specifies default route (0.0.0.0/0) distribution method.
- `default_prepend` (Number) The count of AS prepended to the AS path.
- `filter_chain` (String) Name of the routing filter chain to be used on the output prefixes. If the chain is not specified, then BGP by default accepts everything.
- `filter_select` (String) Name of the routing select chain to be used for prefix selection. If not specified, then default selection is used.
- `keep_sent_attributes` (Boolean) Store in memory sent prefix attributes, required for ' dump-saved-advertisements ' command to work. By default, sent-out prefixes are not stored to preserve the router's memory. An option should be enabled only for debugging purposes when necessary to see currently advertised prefixes.
- `network` (String) Name of the address list used to send local networks. The network is sent only if a matching IGP route exists in the routing table.
- `no_client_to_client_reflection` (Boolean) Disable client-to-client route reflection in Route Reflector setups.
- `no_early_cut` (Boolean) The early cut is the mechanism, to guess (based on default RFC behavior) what would happen with the sent NPLRI when received by the remote peer. If the algorithm determines that the NLRI is going to be dropped, a peer will not even try to send it. However such behavior may not be desired in specific scenarios, then then this option should be used to disable the early cut feature.
- `redistribute` (String) Enable redistribution of specified route types.
- `remove_private_as` (Boolean) If set, then the BGP AS-PATH attribute is removed before sending out route updates if the attribute contains only private AS numbers. The removal process happens before routing filters are applied and before the local, AS number is prepended to the AS path.


<a id="nestedblock--remote"></a>
### Nested Schema for `remote`

Optional:

- `address` (String) Remote IPv4/6 address used to connect and/or listen to.
- `allowed_as` (String) List of remote AS numbers that are allowed to connect. Useful for dynamic peer configuration.
- `as` (String) Remote AS number. If not specified BGP will determine remote AS automatically from the OPEN message.
- `port` (Number) Local connection port.
- `ttl` (Number) Acceptable minimum Time To Live, the hop limit for this TCP connection. For example, if 'ttl=255' then only single-hop neighbors will be able to establish the connection. This property only affects EBGP peers.

## Import
Import is supported using the following syntax:
```shell
#The ID can be found via API or the terminal
#The command for the terminal is -> :put [/routing/bgp/connection get [print show-ids]]
terraform import routeros_routing_bgp_connection.test *3
```
